[TOC]

---



# 数字取证

> Digital Forensics  数字图像取证 Digital Image Forensics

Digital Forensics (sometimes known as digital forensic science) is a branch of forensic science encompassing the recovery and investigation of material found in digital devices, often in relation to computer crime.

数字取证是取证科学的一个分支，包含对从数字设备中获取的材料的恢复和调查，通常这些材料与计算机犯罪有关。



面临挑战：数字图像正面临着被随意篡改和伪造的威胁：

- 如何保证数字图像的真实性
- 如何进行认证
- 如何建立数据警察
- 数字图像能否成为有效司法证据
- 如何鉴别数字图像的完整性、真实性、原始性

发展方向：

- 现有基于统计的算法对训练样本的依赖性较强
- 先用的针对性的非统计取证算法的适应性较弱
- 隐秘分析取证技术(Forensic Steganalysis)
- 现有技术的应用对象都存在一定的局限性

# Basis of Digital Forensics 

The technical aspect of an investigation is divided into several sub-branches:

1. computer forensics 计算机取证
2. network forensics 网络取证
3. database forensics 数据库取证
4. mobile device forensics 移动设备取证

The digital forensic process encompasses:

1. seizure: 捕获
2. forensics imaging(acquisition): 获得
3. analysis of digital media: 数字媒体的分析
4. the production of a report: 制作报告

into collected evidence for the benefit of courts or an employer.

数字图像取证技术(Digital Image Forensics)：通过对**图像统计特性**的分析来判断数字图像内容的**真实性、完整性和原始性**，也是判断数字图像从被数码相机拍摄之后，有没有讲过篡改的技术。

它是**计算机取证**的一个分支，是对源于数字图像资源的数字证据进行**确定、收集、识别、分析及出示法庭**的过程。不同于先前的计算机取证，数字图像取证主要是针对于数字图像内容的完整性和原始性，而不是对计算机文件或磁盘格式的取证。

计算机取证是计算机领域和法学领域的一门交叉学科，被用来解决大量的计算机犯罪和事故，包括网络入侵、盗用知识产权和网络欺骗等。



## 主动取证&被动盲取证

现有的**主动取证**技术包括：

- 以鲁棒数字水印为代表的防伪技术
- 以脆弱数字水印为代表的防篡改技术
- 以数字指纹、数字签名为代表的认证技术



数字图像主动取证应用在图像取证方面，需要有以下三个方面的前提条件：

- 数字图像主动取证需要事先向待认证图像中**嵌入特定的信息**，这就对待认证图像的范围有了很大的限制。
- 主动取证所嵌入的水印必须具有较强的**鲁棒性**，即能够抵抗攻击，不能被轻易去除或者重新嵌入，而这种鲁棒性目前在理论上还不能证明能够完全达到。
- 主动取证水印信息的存储和认证需要**具有权威性的第三方**介入，这第三方需要得到认证双方和法庭的认可。

在这三个前提条件未具备以前，对数字图像的取证不能依靠数字水印来进行，而需要依靠附加条件少的**数字图像被动盲取证**来进行，因此数字图像被动盲取证是目前数字取证研究的主攻方向。

数字图像被动盲取证：

数字图像盲取证(Bind Digital Image Forensics)是指在不依赖任何预签名提取或预嵌入信息的前提下，对图像的真伪和来源进行鉴别和取证。

根据篡改方法，数字图像盲取证可以归纳为三个主要方面：

- **图像篡改检测**：针对图像篡改检测往往从检测图像是否经过复制粘贴、重采样、模糊润饰、**JPEG重压缩**等操作来判断图像是否被篡改，以及确定图像存在篡改的位置
- **图像来源认证**：现代多种数字设备(e.g. 数码相机 扫描仪 计算机)都可以生成数字图像，数字图像来源认证就是要在不明图像来源的情况下，单从数字图像本身来判断它的生成设备
- **图像隐秘分析检测**

根据图像盲取证所使用的取证特征不同，**盲取证**可以分为：

- 基于图像**伪造**过程痕迹进行盲取证：
  - 复制粘贴检测：即图像合成操作，无论是同一幅图像还是两幅不同图像之间的合成都会有这个操作
  - JPEG双压检测：用图像处理软件对伪造好的图像进行重新存储
  - 重采样检测：可能是为了消除简单复制粘贴造成的可是篡改痕迹。
  - 照明不一致检测
  - 模糊估计：模糊润饰是一种消除简单复制粘贴而造成的可视篡改痕迹的操作
- 基于成像设备一致性进行盲取证
  - CFA插值检测
  - 模式噪声检测
  - 色差检测
  - 相机响应一致性检测
- 基于自然图像统计特性进行盲取证
  - 自然图像统计模型
  - 相干系数和边缘百分比特性
  - 图像质量度量二元相似性度量等特征



## 图像来源取证

不同社区设备来源的数字图像虽然在视觉上区别不大，但是由于各种生成图像设备的特性不同，如：

- 镜头
- 感光器件
- 打印机或扫描仪的零部件运动特征

其生成的数字图像也会有不同的特征区别

现有的图像来源认证就是通过分析提取这些能够区别图像来源的特征，建立特征库，试图**对数字图像的来源进行盲取证**。

图像来源取证可以分为以下几个方面：

- 基于**数码相机**的图像来源取证：
  - 不同相机品牌的来源取证
  - 二次获取图像的认证
- 基于**扫描仪**的图像来源取证：(Scanned Image, SIM)
  - 不同扫描仪的来源取证
  - 数码相机和扫描仪的来源取证
- **自然图像和计算机生成图像**分类取证
  - 自然图像(Photographic Image, PIM)，计算机生成图像(Computer Graphics, CG)，扫描仪生成图像的分类取证。

基于数码相机的图像来源取证：在数码相机获得一副自然场景的数字图像过程中，其特性主要取决于两方面：自然场景和相机处理过程。

- 基于自然场景的取证，主要是从相机拍摄图像的光照一致性进行取证
- **基于数码相机处理过程的取证**主要有：相机透镜失真，模式噪声取证，相机**CFA(Color Filter Array)**插值，伽马矫正

基于打印机的图像来源取证：在打印过程中，打印机由于存在零件的波动或者零件结合不完美的地方，在其输出的介质上，会留有“打印质量缺陷”的痕迹，对打印输出介质扫描生成的图像进行认证分析，可以确认输出该介质的打印机品牌，这就是基于打印机的图像来源取证。

自然图像和计算机生成图像分类取证：

由于诸如 3Ds MAX 、Softimage Softimage-xsi 、Maya、Terragen等计算机图像生 成软件的普遍使用，网络上出现了大量计算机生图像 (Computer Graphics, CG)，随着这些软件功能的日益强大，计算机生成图像越来越逼真，在视觉上有些图像与实的自然难以区分。利用计算机生成图像与自然图像在统计特性上的不同来对这两类进行分类取证， 也是数字图像来源取证的一个范畴。



### 图像模式噪声取证

- 由于成像传感器的非理想性，每一种数码相机都会输出一种相对稳定的残留噪声
- 用小波滤波器从数字图像中提取这一噪声
- 利用多幅图像的噪声取平均值的方法建立噪声参考模式
- 求出待鉴别数字图像的噪声与噪声参考模式间的相关系数
- 把这一相关系数与预设的阈值进行比较，判定数字图像来源于哪一种相机

#### 模式噪声种类

- 暗电流产生的固定样本噪声(FPN, Fixed Pattern Noise)
- 光感应不均匀噪声(PRNU, Photo Response Non-Uniformity)
- 激发噪声(Shot Noise)：也就是光子噪声。是一种随即成分

**模式噪声**：只对系统噪声感兴趣，即在不同的图像中基本保持不变的，在相机的使用寿命期内及合理的环境条件下相对稳定的，经过多幅画面平均后其成分不减少的那部分噪声，称它为相机的模式噪声。





## 图像篡改检测

- 数字图像真实性篡改：

  - 合成
  - 变种
  - 润饰
  - 增强
  - 计算机生成

- 数字图像完整性篡改：在图像中隐藏信息是对数字图像数据完整性的篡改。

- 数字图像原始性篡改：二次获取图像

- 数字图像版权篡改：e.g. 水印



数字图像的原始性：指数字图像所拍摄场景的真实性和原始性。数字图像原始性篡改指的是**二次获取图像**。即图像再经过一次数字获取处理后形成的新的数字图像，二次获取图像是相对于“现场”图像而言的。

> 现场图像：景物内容经过一次图像获取设备获得的
>
> 二次获取图像：景物内容经过两次以上图像获取设备获得。



### 复制粘贴篡改操作取证



PCA



### 双重JPEG压缩和重采样



#### JPEG压缩和解压缩

CCITT 定义了几种连续色调的**图象压缩标准**用于处理单色和彩图象压缩的标准，主要以**有损变换编码技术**为基础的

现在最为广泛的是基于DCT的JPEG标准和基于小波的标准JPEG2000，以及JPEG-LS标准

**JPEG图像双重压缩**：JPEG图像双重压缩是指一副JPEG图像被解压，然后用另一个量化表重新压缩存储。

在使用图像编辑软件创作伪造图像的过程中，一副JPEG图像在伪造处理结束后有可能再一次被压缩，并且使用的压缩质量因子不同于原始图像的压缩质量因子。

因此双重JPEG压缩检测可以作为一种辅助手段与别的检测手段一起检测图像是否经过了篡改



#### 重采样原理及二维图像重采样方法

- 最近邻插值法

指定最近邻的整数坐标的灰度值给予插值点，所以最近邻插值方法又称为零阶插值，它会使直线边缘性质的影像产生不必要的变形。

- 双线性插值

Sinc函数重新采样是最理想的插值函数，二双线性插值方法是以一个三角形双线性函数W(xc)来近似Sinc函数
$$
W(x_c)\approx
\begin{aligned} 
& 1-|x_c|, & 0\le |x_c| \le 1\\
& 0,      & 1 < |x_c|\\
\end{aligned}
$$
当以双线性插值时，需要预插值点P周围**4个点**的灰度值才与计算


$$
{\displaystyle {\begin{aligned}f(x,y)&\approx {\frac {y_{2}-y}{y_{2}-y_{1}}}f(x,y_{1})+{\frac {y-y_{1}}{y_{2}-y_{1}}}f(x,y_{2})\\&={\frac {y_{2}-y}{y_{2}-y_{1}}}\left({\frac {x_{2}-x}{x_{2}-x_{1}}}f(Q_{11})+{\frac {x-x_{1}}{x_{2}-x_{1}}}f(Q_{21})\right)+{\frac {y-y_{1}}{y_{2}-y_{1}}}\left({\frac {x_{2}-x}{x_{2}-x_{1}}}f(Q_{12})+{\frac {x-x_{1}}{x_{2}-x_{1}}}f(Q_{22})\right)\\&={\frac {1}{(x_{2}-x_{1})(y_{2}-y_{1})}}{\big (}f(Q_{11})(x_{2}-x)(y_{2}-y)+f(Q_{21})(x-x_{1})(y_{2}-y)+f(Q_{12})(x_{2}-x)(y-y_{1})+f(Q_{22})(x-x_{1})(y-y_{1}){\big )}\\&={\frac {1}{(x_{2}-x_{1})(y_{2}-y_{1})}}{\begin{bmatrix}x_{2}-x&x-x_{1}\end{bmatrix}}{\begin{bmatrix}f(Q_{11})&f(Q_{12})\\f(Q_{21})&f(Q_{22})\end{bmatrix}}{\begin{bmatrix}y_{2}-y\\y-y_{1}\end{bmatrix}}.\end{aligned}}}
$$



无论是最近邻插值、双线性插值、立方回旋插值中的哪种重采样方法，其插值过程中的卷积过程都会使重采样后的信号可能存在线性相关性，目前，很多检测重采样的方法就是检测这个重采样后的信号存在的相关性



- 立方插值法

利用三次式的插值函数V(xc)来近似Sinc函数



#### 重采样操作取证

在进行不同的图像之间剪切或者复制、黏贴等篡改时，为了使以后的图像不引起视觉上怀疑，往往需要对剪切的部分图像进行缩放、旋转等，
这就对图像进行了重采样操作，该操作会造成图像数据之间特殊的相关性，通过检测这种相关性，可以判断一幅图像是否经过了重采样。

由于立方回旋插值的复杂性以及最邻近插值性能不完善性，大多数图像处理软件对图像重采样处理一般均选用双线性插值






## 图像隐秘分析检测

- 图像是否完整
- 是否被嵌入了不可见的秘密信息
- 嵌入的信息是什么

图像隐秘分析分为主动攻击和被动检测：

- 主动攻击的目标是破坏或者篡改传输的秘密信息
- 被动攻击的目标是检测到隐秘信息的存在





## Papers

### Sensor Pattern Noise Estimation Based on Improved Locally Adaptive DCT Filtering and Weighted Averaging for Source Camera Identification and Verification

> 传感器模式噪声 Sensor Pattern Noise SPN

照相机输出可以表示如下：
$$
I = I^{0} + I^{0}K + \Theta
$$
其中$I^{0}$表示图像的原始输入，$I^{0}K$表示PRNU term，$\Theta​$表示random noise factor.

SPN在原始图像上的影响遵循multiplicative rule. 乘性法则（即两个变量无关，概率分布不受对方影响）

noise residue 噪声残留的提取过程：
$$
r = I - F(I); F: filter
$$
噪声残留中包含PRNU，F(I)表示对图片进行滤波。

